<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="favicon.png">
    <title>Join QuantG – Create an Account</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="stylesforforms.css">
    <link rel="stylesheet" href="stylesfornavigationbar.css">
    <link rel="stylesheet" href="../common_style_script/stylesforlogo.css">
    <link rel="stylesheet" href="../common_style_script/stylesforcursor.css">
    <link rel="stylesheet" href="../common_style_script/stylesforfooter.css">
    <link rel="stylesheet" href="../common_style_script/stylesforsharebtn.css">
    <link rel="stylesheet" href="../common_style_script/stylesforhamburger.css">
    <script>
function toggleAllPasswords() {
            const passwordFields = document.querySelectorAll('#password, #confirmPassword');
            const checkbox = document.getElementById("showAllPasswords");

            passwordFields.forEach(field => {
                field.type = checkbox.checked ? "text" : "password";
            });
        }
    </script>
</head>
<body>
  <div class="header-background"></div>
  <div class="logo">
    <div class="logo-container">
      <div class="quantg">
        <span class="q">Q</span>
        <span class="u">u</span>
        <span class="a">a</span>
        <span class="n">n</span>
        <span class="t">t</span>
        <span class="g">G</span>
      </div>
      <div class="motto">BEYOND GAMING</div>
    </div>
  </div>

<!-- Hamburger Menu Icon -->
<div class="hamburger-menu" onclick="toggleMenu()">
    ☰
</div>

<!-- Sidebar Menu -->
<div id="sidebar" class="sidebar">
    <a href="javascript:void(0)" class="close-btn" onclick="toggleMenu()">✖</a>
    <a href="../Home/index.html">Home</a>
    <a href="../Explore/allgamepage/index.html">Explore</a>
    <a href="../About/index.html">About</a>
    <a href="../Contact/index.html">Contact</a>
</div>

    <!--Header-->
    <header>
        <div class="navigation-bar">
            <div class="navi-text">
                <a href="../Home/index.html" class="items-nav">Home</a>
                <a href="../Explore/allgamepage/index.html" class="items-nav">Explore</a>
                <a href="../login/login.html" class="items-nav">Signup/Login</a>
                <a href="../About/index.html" class="items-nav">About</a>
                <a href="../Contact/index.html" class="items-nav">Contact</a>
                <span id="navigator"></span>
            </div>
        </div>

    </header>
<div class="signup-body">
    <div class="signup-container">
      <h1>Signup</h1>
      
      <div class="signup-group">
      <input type="text" id="firstName" name="firstName" placeholder="" required>
      <label for="firstName">First Name</label>
      <i class="fas fa-user signup-icon"></i>
      </div>

      <div class="signup-group">
      <input type="text" id="lastName" name="lastName" placeholder="" required>
      <label for="lastName">Last Name</label>
      <i class="fas fa-user signup-icon"></i>
      </div>

      <div class="signup-group">
      <input type="email" id="email" name="email" placeholder="" required>
      <label for="email">Email</label>
      <i class="fas fa-envelope signup-icon"></i>
      </div>

      <button id="sendCode">Send OTP</button>
      
      <div class="signup-group">
      <input type="text" id="emailCode" name="emailCode" placeholder="" required>
      <label for="emailCode">Email Confirmation Code</label>
      <i class="fas fa-key signup-icon"></i>
      </div>

      <button id="verifyCode" style="display: none; margin-bottom: 1vmax;">Verify OTP</button>
      
      <div class="signup-group">
      <input type="password" id="password" name="password" placeholder="" required>
      <label for="password">Password</label>
      <i class="fas fa-lock signup-icon"></i>
      </div>

      <div class="signup-group">
      <input type="password" id="confirmPassword" name="confirmPassword" placeholder="" required>
      <label for="confirmPassword">Confirm Password</label>
      <i class="fas fa-lock signup-icon"></i>
      </div>

      <label for="showAllPasswords" style="position: relative; left: 1vmax;">
          <input type="checkbox" id="showAllPasswords" onclick="toggleAllPasswords()" > <p>Show all passwords</p>
      </label>
      
      <button id="signup" style="display: none;">Signup</button>
  
      <p class="login" style="color:#bbb9b9;">Already have an account? <a href="../login/login.html" >Login</a></p>
  </div>
  </div>

<!-- Share Button and Social Icons -->
<div class="unique-body">
    <!-- Fixed Button to Trigger Icons -->
    <div class="unique-button" id="unique-button">
        <i class="fas fa-share-alt"></i> <!-- Share icon -->
    </div>
    
    <!-- Social Icons (Initially Hidden) -->
    <div class="unique-social-icons" id="unique-social-icons">
        <a href="https://facebook.com" target="_blank" class="facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="https://instagram.com" target="_blank" class="instagram"><i class="fab fa-instagram"></i></a>
        <a href="https://discord.com" target="_blank" class="discord"><i class="fab fa-discord"></i></a>
        <a href="https://github.com" target="_blank" class="github"><i class="fab fa-github"></i></a>
    </div>
</div>

  <!--Footer-->
  <footer>
    <div class="footer">
      <div class="footer-content">
        <p>Join our community: USMIA</p>
        <p>
            <a href="../Home/index.html">Home</a> | 
            <a href="../Explore/allgamepage/index.html">Explore</a> | 
            <a href="../About/index.html">About us</a> | 
            <a href="../Contact/index.html">Contact us</a>
        </p>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 QuantG. All rights reserved.</p>
      </div>
    </div>
  </footer>

<script type="module">

// Send OTP// Send OTP
document.getElementById("sendCode").addEventListener("click", async function (event) {
    event.preventDefault();

    const email = document.getElementById("email").value.trim();
    if (!validateEmail(email)) {
        alert("Please enter a valid email address.");
        return;
    }

    try {
        // Check if email exists
        let response = await fetch("https://quant-c6ypvvefy-usmia.vercel.app/api/index?action=checkEmail", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email })
        });

        if (!response.ok) throw new Error("Server error while checking email.");
        let data = await response.json();

        if (data.success) {
            alert("Email already registered. Please login.");
            return;
        }

        // Send OTP
        response = await fetch("https://quant-c6ypvvefy-usmia.vercel.app/api/index?action=sendOtpSignup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email })
        });

        console.log("response", response);
        if (!response.ok) throw new Error("Server error while sending OTP.");
        data = await response.json();

        if (data.success) {
            alert("OTP sent to your email!");
            document.getElementById("verifyCode").style.display = "inline-block"; // Show verify button
        } else {
            alert(data.message || "Failed to send OTP.");
        }
    } catch (error) {
        console.error("Error:", error);
        alert("Error: " + error.message);
    }
});

// Verify OTP
document.getElementById("verifyCode").addEventListener("click", async function (event) {
    event.preventDefault();

    const email = document.getElementById("email").value.trim();
    const otp = document.getElementById("emailCode").value.trim();

    if (!otp) {
        alert("Please enter the OTP.");
        return;
    }

    try {
        let response = await fetch("https://quant-c6ypvvefy-usmia.vercel.app/api/index?action=verifyOtp", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, otp })
        });

        if (!response.ok) throw new Error("Server error while verifying OTP.");
        let data = await response.json();

        if (data.success) {
            alert("OTP verified successfully!");
            document.getElementById("signup").style.display = "inline-block"; // Show signup button
        } else {
            alert(data.message || "Invalid OTP.");
        }
    } catch (error) {
        console.error("Error:", error);
        alert("Error: " + error.message);
    }
});

// Signup after OTP verification
document.getElementById("signup").addEventListener("click", async function (e) {
    e.preventDefault();

    const firstName = document.getElementById("firstName").value.trim();
    const lastName = document.getElementById("lastName").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    const confirmPassword = document.getElementById("confirmPassword").value;

    if (!firstName || !lastName || !email || !password) {
        alert("All fields are required.");
        return;
    }

    if (password !== confirmPassword) {
        alert("Passwords do not match.");
        return;
    }

    try {
        let response = await fetch("https://quant-c6ypvvefy-usmia.vercel.app/api/index?action=signup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ firstName, lastName, email, password })
        });

        if (!response.ok) throw new Error("Server error while signing up.");
        let data = await response.json();

        if (data.success) {
            alert("Signup successful! Redirecting to login...");
            window.location.href = "../login/login.html"; // Redirect after signup
        } else {
            alert(data.message || "Signup failed.");
        }
    } catch (error) {
        console.error("Error:", error);
        alert("Error: " + error.message);
    }
});

// Email format validation
function validateEmail(email) {
    const re = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
    return re.test(email.toLowerCase());
}

</script>
<script src="../common_style_script/scriptforfooter.js"></script>
<script src="../common_style_script/scriptforhamburger.js"></script>
<script src="../common_style_script/scriptformouseflare.js"></script>
<script src="../common_style_script/scriptforsocialicons.js"></script>
<script src="../common_style_script/scriptforavigationbar.js"></script>
    
</body>
</html>
